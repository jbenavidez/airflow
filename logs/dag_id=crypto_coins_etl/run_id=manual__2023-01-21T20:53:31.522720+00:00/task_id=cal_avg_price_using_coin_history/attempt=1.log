[2023-01-21T20:53:40.328+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: crypto_coins_etl.cal_avg_price_using_coin_history manual__2023-01-21T20:53:31.522720+00:00 [queued]>
[2023-01-21T20:53:40.341+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: crypto_coins_etl.cal_avg_price_using_coin_history manual__2023-01-21T20:53:31.522720+00:00 [queued]>
[2023-01-21T20:53:40.342+0000] {taskinstance.py:1279} INFO - 
--------------------------------------------------------------------------------
[2023-01-21T20:53:40.343+0000] {taskinstance.py:1280} INFO - Starting attempt 1 of 1
[2023-01-21T20:53:40.343+0000] {taskinstance.py:1281} INFO - 
--------------------------------------------------------------------------------
[2023-01-21T20:53:40.357+0000] {taskinstance.py:1300} INFO - Executing <Task(PythonOperator): cal_avg_price_using_coin_history> on 2023-01-21 20:53:31.522720+00:00
[2023-01-21T20:53:40.363+0000] {standard_task_runner.py:55} INFO - Started process 3574 to run task
[2023-01-21T20:53:40.368+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'crypto_coins_etl', 'cal_avg_price_using_coin_history', 'manual__2023-01-21T20:53:31.522720+00:00', '--job-id', '195', '--raw', '--subdir', 'DAGS_FOLDER/crypto_coins_etl.py', '--cfg-path', '/tmp/tmpgl4n55l2']
[2023-01-21T20:53:40.372+0000] {standard_task_runner.py:83} INFO - Job 195: Subtask cal_avg_price_using_coin_history
[2023-01-21T20:53:40.450+0000] {task_command.py:388} INFO - Running <TaskInstance: crypto_coins_etl.cal_avg_price_using_coin_history manual__2023-01-21T20:53:31.522720+00:00 [running]> on host 6256f74551c5
[2023-01-21T20:53:40.523+0000] {taskinstance.py:1507} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=crypto_coins_etl
AIRFLOW_CTX_TASK_ID=cal_avg_price_using_coin_history
AIRFLOW_CTX_EXECUTION_DATE=2023-01-21T20:53:31.522720+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2023-01-21T20:53:31.522720+00:00
[2023-01-21T20:53:40.538+0000] {crypto_transformer.py:40} INFO - calculate_avg_price bitcoin
[2023-01-21T20:53:40.873+0000] {crypto_transformer.py:53} INFO - Checking price for bitcoin
[2023-01-21T20:53:40.882+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:40.883+0000] {logging_mixin.py:137} INFO - must_buy_coins {'id': 'bitcoin', 'symbol': 'btc', 'current_price': 23177, 'is_valid_to_buy': False, 'avg_price': 21068.69743773949}
[2023-01-21T20:53:40.890+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:40.894+0000] {crypto_transformer.py:40} INFO - calculate_avg_price ethereum
[2023-01-21T20:53:41.070+0000] {crypto_transformer.py:53} INFO - Checking price for ethereum
[2023-01-21T20:53:41.071+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:41.072+0000] {logging_mixin.py:137} INFO - must_buy_coins {'id': 'ethereum', 'symbol': 'eth', 'current_price': 1659.24, 'is_valid_to_buy': False, 'avg_price': 1550.4303613897966}
[2023-01-21T20:53:41.073+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:41.073+0000] {crypto_transformer.py:40} INFO - calculate_avg_price tether
[2023-01-21T20:53:41.364+0000] {crypto_transformer.py:53} INFO - Checking price for tether
[2023-01-21T20:53:41.365+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:41.366+0000] {logging_mixin.py:137} INFO - must_buy_coins {'id': 'tether', 'symbol': 'usdt', 'current_price': 1.0, 'is_valid_to_buy': True, 'avg_price': 1.0004248657734074}
[2023-01-21T20:53:41.367+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:41.368+0000] {crypto_transformer.py:40} INFO - calculate_avg_price usd-coin
[2023-01-21T20:53:41.654+0000] {crypto_transformer.py:53} INFO - Checking price for usd-coin
[2023-01-21T20:53:41.656+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:41.657+0000] {logging_mixin.py:137} INFO - must_buy_coins {'id': 'usd-coin', 'symbol': 'usdc', 'current_price': 1.001, 'is_valid_to_buy': False, 'avg_price': 1.000065194164591}
[2023-01-21T20:53:41.657+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:41.658+0000] {crypto_transformer.py:40} INFO - calculate_avg_price binancecoin
[2023-01-21T20:53:41.932+0000] {crypto_transformer.py:53} INFO - Checking price for binancecoin
[2023-01-21T20:53:41.934+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:41.934+0000] {logging_mixin.py:137} INFO - must_buy_coins {'id': 'binancecoin', 'symbol': 'bnb', 'current_price': 303.84, 'is_valid_to_buy': False, 'avg_price': 297.92500318821567}
[2023-01-21T20:53:41.935+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:41.936+0000] {crypto_transformer.py:40} INFO - calculate_avg_price ripple
[2023-01-21T20:53:42.210+0000] {crypto_transformer.py:53} INFO - Checking price for ripple
[2023-01-21T20:53:42.211+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:42.212+0000] {logging_mixin.py:137} INFO - must_buy_coins {'id': 'ripple', 'symbol': 'xrp', 'current_price': 0.412407, 'is_valid_to_buy': False, 'avg_price': 0.3918020866276282}
[2023-01-21T20:53:42.212+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:42.213+0000] {crypto_transformer.py:40} INFO - calculate_avg_price binance-usd
[2023-01-21T20:53:42.517+0000] {crypto_transformer.py:53} INFO - Checking price for binance-usd
[2023-01-21T20:53:42.519+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:42.521+0000] {logging_mixin.py:137} INFO - must_buy_coins {'id': 'binance-usd', 'symbol': 'busd', 'current_price': 1.001, 'is_valid_to_buy': False, 'avg_price': 0.9996293012808688}
[2023-01-21T20:53:42.523+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:42.524+0000] {crypto_transformer.py:40} INFO - calculate_avg_price cardano
[2023-01-21T20:53:42.832+0000] {crypto_transformer.py:53} INFO - Checking price for cardano
[2023-01-21T20:53:42.833+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:42.834+0000] {logging_mixin.py:137} INFO - must_buy_coins {'id': 'cardano', 'symbol': 'ada', 'current_price': 0.375437, 'is_valid_to_buy': False, 'avg_price': 0.3479774261031352}
[2023-01-21T20:53:42.836+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:42.837+0000] {crypto_transformer.py:40} INFO - calculate_avg_price dogecoin
[2023-01-21T20:53:43.121+0000] {crypto_transformer.py:53} INFO - Checking price for dogecoin
[2023-01-21T20:53:43.122+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:43.123+0000] {logging_mixin.py:137} INFO - must_buy_coins {'id': 'dogecoin', 'symbol': 'doge', 'current_price': 0.087657, 'is_valid_to_buy': False, 'avg_price': 0.08411247343776314}
[2023-01-21T20:53:43.124+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:43.125+0000] {crypto_transformer.py:40} INFO - calculate_avg_price solana
[2023-01-21T20:53:43.410+0000] {crypto_transformer.py:53} INFO - Checking price for solana
[2023-01-21T20:53:43.411+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:43.412+0000] {logging_mixin.py:137} INFO - must_buy_coins {'id': 'solana', 'symbol': 'sol', 'current_price': 25.58, 'is_valid_to_buy': False, 'avg_price': 22.193973729786517}
[2023-01-21T20:53:43.412+0000] {logging_mixin.py:137} INFO - ----
[2023-01-21T20:53:43.413+0000] {python.py:177} INFO - Done. Returned value was: <map object at 0x7f6148288fa0>
[2023-01-21T20:53:43.423+0000] {taskinstance.py:1768} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/session.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 2290, in xcom_push
    XCom.set(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/session.py", line 72, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/xcom.py", line 234, in set
    value = cls.serialize_value(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/xcom.py", line 627, in serialize_value
    return json.dumps(value, cls=XComEncoder).encode("UTF-8")
  File "/usr/local/lib/python3.8/json/__init__.py", line 234, in dumps
    return cls(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/json.py", line 176, in encode
    return super().encode(o)
  File "/usr/local/lib/python3.8/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/local/lib/python3.8/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/json.py", line 153, in default
    CLASSNAME: o.__module__ + "." + o.__class__.__qualname__,
AttributeError: 'map' object has no attribute '__module__'
[2023-01-21T20:53:43.437+0000] {taskinstance.py:1318} INFO - Marking task as FAILED. dag_id=crypto_coins_etl, task_id=cal_avg_price_using_coin_history, execution_date=20230121T205331, start_date=20230121T205340, end_date=20230121T205343
[2023-01-21T20:53:43.449+0000] {standard_task_runner.py:100} ERROR - Failed to execute job 195 for task cal_avg_price_using_coin_history ('map' object has no attribute '__module__'; 3574)
[2023-01-21T20:53:43.490+0000] {local_task_job.py:208} INFO - Task exited with return code 1
[2023-01-21T20:53:43.511+0000] {taskinstance.py:2578} INFO - 0 downstream tasks scheduled from follow-on schedule check
